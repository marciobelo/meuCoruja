<!DOCTYPE html>
<html>
<head>
        
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="Content-Type" content="text/html; charset=windows-1252" />
	<title>Boletim</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        <link rel="stylesheet" type="text/css" href="css/tabela.css">
        <link rel="stylesheet" type="text/css" href="css/estilo.css">
        
        <script>
            $(document).ready(function(){
                $.ajax({url: "endpoint_boletim.php",
                    success: function(result,status,jqXHR){
                        console.log(jqXHR.status);
                        boletim = JSON.parse(result);
                        for (var i = 0; i < boletim.length; i++) {
                             $("#boletim").find('tbody')
                                 .append(($('<tr>'))
                                     .append($("<td data-label='Disciplina' id='linha"+[i]+".nome'>" + boletim[i][0].siglaDisciplina + "</td>"))
                                     .append($("<td data-label='AV1'>" + boletim[i][1][0].nota + "</td>"))
                                     .append($("<td data-label='AV2'>" + boletim[i][1][1].nota + "</td>"))
                                     .append($("<td data-label='Média'>" + boletim[i][1][2].nota + "</td>"))
                                     .append($("<td data-label='AVF'>" + boletim[i][1][3].nota + "</td>"))
                                     .append($("<td data-label='Média Final'>" + boletim[i][1][4].nota + "</td>"))
                                     .append($("<td data-label='Professor'>" + boletim[i][0].nomeProfessor + "</td>"))
                                     .append($("<td data-label='Faltas'><span>"+boletim[i][0].faltas+"</span>/<span>"+boletim[i].faltasMax+"</span><a href= 'detalhamentoFaltas.php'><input type='image'  class='informacao' src='img/information-circular-button.png'></a></td>"))
                                );
                            console.log(boletim[i]);
                            var disciplinaBoletim=new Array();
                            disciplinaBoletim=boletim;
                            localStorage.setItem("Boletim", JSON.stringify(disciplinaBoletim));
                            
                        }
                        
                },error: function(jqXHR){
                    //console.log(jqXHR.status);
                    if(jqXHR.status === 401){
                        window.open("index.html","_self");
                    }else if(localStorage.nomeUsuario !== null){
                        for(var i=0; i<localStorage.length; i++){
                            $("#linha["+[i]+"].nome").html(localStorage.getItem("linha["+[i]+"].nome"));
                            //console.log("#linha"+[i]+".nome");
                            //console.log(localStorage.getItem("linha[0].nome"));
                        }
                    }else{
                        console.log("Erro ao obter dados do localStorage");
                    }
                }});
            }); 
            
            $(document).ready(function (){ 
                jQuery(document).ready(adicionarSideBar);

                function adicionarSideBar() {
                    $.get("sidebar.html",function(sidebar){
                        $('body').prepend(sidebar);
                    });
                }
            });
            
            
            
            
        </script>
        
        

</head>
<body class="link1">

    <div class="site-wrap">
        
	<h1>Boletim</h1>
            <div id="div1"><h2></h2></div>
            <table id="boletim">
                <thead>
		    <tr>
                        <th>Disciplina</th>
                        
                        <th>AV1</th>
                        <th>AV2</th>
                        <th>Média</th>
                        <th>AVF</th>
                        <th>Média Final</th>
                        <th>Professor</th>
                        <th>Faltas</th>
		    </tr>
		</thead>
                    <tbody>
                    </tbody>
            </table>
	</div>
	<!-- Modal -->
        <div id="myModal" class="modal fade" role="dialog">
	  <div class="modal-dialog">
		<!-- Modal content-->
		<div class="modal-content">
                    <div class="modal-header">
			<button type="button" class="close" data-dismiss="modal">&times;</button>
			<h4 class="modal-title">Detalhamento de faltas</h4>
                    </div>
                    <div class="modal-body">
			<table>
                            <thead>
                                <tr>
                                    <th>Data</th>
                                    <th>Quantidade</th>
				</tr>
                            </thead>
                            <tbody>
				<tr>
                                    <td data-label="Data">03/04/17</td>
                                    <td data-label="Quantidade">3</td>
				</tr>
				<tr>
                                    <td data-label="Data">15/05/17</td>
                                    <td data-label="Quantidade">6</td>
				</tr>
				<tr>
                                    <td data-label="Data">17/05/17</td>
                                    <td data-label="Quantidade">3</td>
				</tr>

                            </tbody>
			</table>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Fechar</button>
                    </div>
		</div>

            </div>
	</div>
</body>
</html>