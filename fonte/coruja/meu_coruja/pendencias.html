<html>
    <head>

        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="Content-Type" content="text/html; charset=windows-1252" />
        <title>Pendências</title>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        <link rel="stylesheet" type="text/css" href="css/tabela.css">
        <link rel="stylesheet" type="text/css" href="css/estilo.css">
        <script>
            $(document).ready(function () {
                jQuery(document).ready(adicionarSideBar);

                function adicionarSideBar() {
                    $.get("sidebar.html", function (sidebar) {
                        $('body').prepend(sidebar);
                    });
                }
            });




            $(document).ready(function () {
                $.ajax({url: "endpoint_pendencias.php",
                    success: function (result, status, jqXHR) {
                        console.log(jqXHR.status);
                        pendencias = JSON.parse(result);
                        console.log(pendencias);



                        for (var i = 0; i < pendencias.length; i++) {
                            $("#historico").find('tbody')
                                    .append(($('<tr>'))
                                            .append($("<td data-label='Disciplina' data-tooltip='"+pendencias[i].nomeDisciplina+"'>" + pendencias[i].siglaDisciplina + "</td>"))
                                            //.append($("<td data-label='Média Final'>" + pendencias[i].nomeDisciplina + "</td>"))
                                            .append($("<td data-label='Carga Horária'>" + pendencias[i].cargaHoraria + " hrs</td>"))
                                            .append($("<td data-label='Período'>" + pendencias[i].periodo + "º Período</td>"))
                                            );

                        }
                        cachePendencias = pendencias;
                        localStorage.setItem("meuCoruja.Pendencias", JSON.stringify(cachePendencias));

                    }, error: function (jqXHR) {
                        //console.log(jqXHR.status);
                        if (jqXHR.status === 401) {
                            window.open("index.html", "_self");
                        } else if (localStorage.nomeUsuario !== null) {
                            for (var i = 0; i < localStorage.length; i++) {
                                $("#linha[" + [i] + "].nome").html(localStorage.getItem("linha[" + [i] + "].nome"));
                                //console.log("#linha"+[i]+".nome");
                                //console.log(localStorage.getItem("linha[0].nome"));
                            }
                        } else {
                            console.log("Erro ao obter dados do localStorage");
                        }
                    }});
            });


        </script>
    </head>
    <body class="link3">

        <div class="site-wrap">
            <h1 class="titulo-pagina">Disciplinas Pendentes</h1>


            <table  id="historico">
                <thead>
                    <tr>
                        <th>Disciplina</th>
                        <th>Carga Horária </th>
                        <th>Período</th>
                    </tr>
                </thead>
                <tbody>

                </tbody>
            </table>

        </div>

    </body>
</html>


